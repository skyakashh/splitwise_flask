{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">Expenses</h2>

<div class="card p-4 shadow-sm mb-4">
    <form action="/add_expense" method="post" class="row g-3">

        <div class="col-md-3">
            <input name="description" class="form-control" placeholder="Description">
        </div>

        <div class="col-md-2">
            <input name="amount" class="form-control" placeholder="Amount" type="number" step="0.01">
        </div>

        <div class="col-md-2">
            <select name="category" class="form-select">
                <option value="Food">ğŸ” Food</option>
                <option value="Travel">âœˆï¸ Travel</option>
                <option value="Utilities">ğŸ’¡ Utilities</option>
                <option value="Entertainment">ğŸ¬ Entertainment</option>
                <option value="Shopping">ğŸ›ï¸ Shopping</option>
                <option value="Health">âš•ï¸ Health</option>
                <option value="Education">ğŸ“š Education</option>
                <option value="Other">ğŸ“Œ Other</option>
            </select>
        </div>

        <div class="col-md-2">
            <select name="paid_by" class="form-select">
                {% for u in users %}
                <option value="{{ u.id }}">{{ u.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-2">
            <select name="group_id" class="form-select">
                {% for g in groups %}
                <option value="{{ g.id }}">{{ g.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-12">
            <button class="btn btn-success w-100">Add Expense</button>
        </div>

    </form>
</div>

<h3>All Expenses</h3>

<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Description</th>
                <th>Category</th>
                <th>Amount (â‚¹)</th>
                <th>Paid By</th>
            </tr>
        </thead>
        <tbody>
        {% for e in expenses %}
            {% set paid_by_name = '' %}
            {% for u in users %}
                {% if u.id == e.paid_by %}
                    {% set paid_by_name = u.name %}
                {% endif %}
            {% endfor %}
            <tr>
                <td>{{ e.description }}</td>
                <td><span class="badge bg-info">{{ e.category or 'Other' }}</span></td>
                <td>{{ "%.2f"|format(e.amount) }}</td>
                <td>{{ paid_by_name }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
